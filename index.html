<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Cek Nilai Siswa</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  font-family:Arial, sans-serif;
  background:#f0f6ff;
  padding:20px;
}
.container{
  max-width:500px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
  box-shadow:0 2px 10px rgba(0,0,0,.1);
}
h2{text-align:center;color:#0b5ed7}
input,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  font-size:16px;
}
button{
  background:#0b5ed7;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
#hasil{
  margin-top:20px;
  display:none;
  text-align:center;
}
img{
  width:120px;
  height:150px;
  object-fit:cover;
  border:1px solid #ccc;
  margin-bottom:10px;
}
</style>
</head>

<body>
<div class="container">
  <h2>CEK NILAI SISWA</h2>

  <input type="text" id="nisn" placeholder="Masukkan NISN">
  <button onclick="cekData()">Cek Data</button>

  <div id="hasil"></div>
</div>

<script>
const SHEET_ID = "1BCxVPh9XYDPRVCVx54Y0GskfwomYeMqSd6KWD3nBHOg";
const SHEET_NAME = "Sheet1";
const URL = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;

function normalNISN(x){
  return String(x).replace(/^0+/, '');
}

async function cekData(){
  const nisnInput = document.getElementById("nisn").value.trim();
  const hasil = document.getElementById("hasil");

  if(!nisnInput){
    alert("Masukkan NISN");
    return;
  }

  hasil.style.display="none";
  hasil.innerHTML = "Memuat...";

  try{
    const res = await fetch(URL);
    const data = await res.json();

    const cari = normalNISN(nisnInput);

    const siswa = data.find(s =>
      normalNISN(s.nisn || s.NISN) === cari
    );

    if(!siswa){
      alert("Data siswa tidak ditemukan");
      return;
    }

    const foto = siswa.foto || siswa.FOTO
      ? (siswa.foto || siswa.FOTO)
      : "https://via.placeholder.com/120x150?text=Foto";

    hasil.innerHTML = `
      <img src="${foto}">
      <p><b>Nama:</b> ${siswa.nama || siswa.Nama}</p>
      <p><b>Kelas:</b> ${siswa.kelas || siswa.Kelas}</p>
      <p><b>Nilai:</b> ${siswa.nilai || siswa.Nilai}</p>
    `;
    hasil.style.display="block";

  }catch(e){
    alert("Gagal mengambil data");
    console.error(e);
  }
}
</script>
</body>
</html>
